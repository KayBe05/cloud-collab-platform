{% extends "base.html" %}

{% block title %}Home - CloudX Platform v2.1{% endblock %}

{% block breadcrumb %}
<i class="fas fa-home"></i>
<i class="fas fa-chevron-right"></i>
<span>Home</span>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
  <div class="hero-content">
    <div class="hero-text">
      <h1 class="hero-title">
        Welcome to <span class="gradient-text">CloudX Platform</span>
      </h1>
      <p class="hero-subtitle">
        Enterprise-grade cloud development environment with integrated CI/CD pipelines, real-time collaboration, and
        advanced monitoring capabilities. Build, deploy, and scale your applications with confidence.
      </p>
      <div class="hero-buttons">
        <a href="/dashboard" class="btn btn-primary">
          <i class="fas fa-rocket"></i> Get Started
        </a>
        <a href="/projects" class="btn btn-secondary">
          <i class="fas fa-folder-open"></i> View Projects
        </a>
      </div>
    </div>
    <div class="hero-visual">
      <div class="floating-card">
        <i class="fas fa-server"></i>
        <span>High Performance</span>
      </div>
      <div class="floating-card">
        <i class="fas fa-shield-alt"></i>
        <span>Enterprise Security</span>
      </div>
      <div class="floating-card">
        <i class="fas fa-bolt"></i>
        <span>Lightning Fast</span>
      </div>
      <div class="floating-card">
        <i class="fas fa-users"></i>
        <span>Team Ready</span>
      </div>
    </div>
  </div>
</section>

<!-- Stats Overview -->
<section class="stats-grid">
  <div class="stat-card animate-in" style="animation-delay: 0.1s;">
    <div class="stat-icon blue">
      <i class="fas fa-project-diagram"></i>
    </div>
    <div class="stat-content">
      <h3 class="stat-value">{{ stats.total_projects }}</h3>
      <p class="stat-label">Active Projects</p>
      <span class="stat-trend positive">
        <i class="fas fa-arrow-up"></i> 12% this month
      </span>
    </div>
  </div>

  <div class="stat-card animate-in" style="animation-delay: 0.2s;">
    <div class="stat-icon green">
      <i class="fas fa-rocket"></i>
    </div>
    <div class="stat-content">
      <h3 class="stat-value">{{ stats.active_deployments }}</h3>
      <p class="stat-label">Live Deployments</p>
      <span class="stat-trend positive">
        <i class="fas fa-arrow-up"></i> 8% this week
      </span>
    </div>
  </div>

  <div class="stat-card animate-in" style="animation-delay: 0.3s;">
    <div class="stat-icon purple">
      <i class="fas fa-history"></i>
    </div>
    <div class="stat-content">
      <h3 class="stat-value">{{ stats.total_activities }}</h3>
      <p class="stat-label">System Activities</p>
      <span class="stat-trend positive">
        <i class="fas fa-arrow-up"></i> 24% today
      </span>
    </div>
  </div>

  <div class="stat-card animate-in" style="animation-delay: 0.4s;">
    <div class="stat-icon orange">
      <i class="fas fa-heart-pulse"></i>
    </div>
    <div class="stat-content">
      <h3 class="stat-value">99.9%</h3>
      <p class="stat-label">Uptime SLA</p>
      <span class="stat-trend positive">
        <i class="fas fa-check-circle"></i> Healthy
      </span>
    </div>
  </div>
</section>

<!-- Features Section -->
<section class="features-section">
  <h2 class="section-title">Platform Features</h2>

  <div class="features-grid">
    <article class="feature-card animate-in" style="animation-delay: 0.1s;">
      <div class="feature-icon">
        <i class="fas fa-code"></i>
      </div>
      <h3>Browser-based IDE</h3>
      <p>Full-featured VS Code environment accessible from anywhere. Complete with syntax highlighting, IntelliSense,
        and thousands of extensions for ultimate productivity.</p>
      <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer" class="feature-link">
        Open Editor <i class="fas fa-arrow-right"></i>
      </a>
    </article>

    <article class="feature-card animate-in" style="animation-delay: 0.2s;">
      <div class="feature-icon">
        <i class="fas fa-database"></i>
      </div>
      <h3>PostgreSQL Database</h3>
      <p>Enterprise-grade relational database with automatic backups, high availability, advanced query optimization,
        and full ACID compliance for your data.</p>
      <a href="/dbtest" class="feature-link">
        Test Connection <i class="fas fa-arrow-right"></i>
      </a>
    </article>

    <article class="feature-card animate-in" style="animation-delay: 0.3s;">
      <div class="feature-icon">
        <i class="fab fa-docker"></i>
      </div>
      <h3>Docker Containers</h3>
      <p>Isolated, reproducible development environments. Consistent deployments across development, staging, and
        production with containerization technology.</p>
      <a href="/dashboard" class="feature-link">
        View Containers <i class="fas fa-arrow-right"></i>
      </a>
    </article>

    <article class="feature-card animate-in" style="animation-delay: 0.4s;">
      <div class="feature-icon">
        <i class="fas fa-sync-alt"></i>
      </div>
      <h3>CI/CD Pipeline</h3>
      <p>Automated testing and deployment with GitHub Actions. Push code and watch it deploy automatically with
        zero-downtime rollouts and instant rollback capabilities.</p>
      <a href="/analytics" class="feature-link">
        View Pipeline <i class="fas fa-arrow-right"></i>
      </a>
    </article>

    <article class="feature-card animate-in" style="animation-delay: 0.5s;">
      <div class="feature-icon">
        <i class="fas fa-chart-line"></i>
      </div>
      <h3>Real-time Analytics</h3>
      <p>Monitor system performance, track deployments, and analyze metrics with beautiful interactive dashboards.
        Get insights that drive better decisions.</p>
      <a href="/analytics" class="feature-link">
        View Analytics <i class="fas fa-arrow-right"></i>
      </a>
    </article>

    <article class="feature-card animate-in" style="animation-delay: 0.6s;">
      <div class="feature-icon">
        <i class="fas fa-users"></i>
      </div>
      <h3>Team Collaboration</h3>
      <p>Work together in real-time with shared workspaces, live editing, presence indicators, and integrated
        communication tools for seamless teamwork.</p>
      <a href="/projects" class="feature-link">
        Start Collaborating <i class="fas fa-arrow-right"></i>
      </a>
    </article>
  </div>
</section>

<!-- Recent Activity -->
<section class="activity-section">
  <div class="section-header">
    <h2 class="section-title">Recent Activity</h2>
    <a href="/dashboard" class="view-all-link">
      View All <i class="fas fa-arrow-right"></i>
    </a>
  </div>

  <div class="activity-list">
    {% for activity in stats.recent_activities[:5] %}
    <div class="activity-item">
      <div class="activity-icon">
        <i class="fas fa-circle"></i>
      </div>
      <div class="activity-content">
        <p class="activity-action">{{ activity.action | replace('_', ' ') | title }}</p>
        {% if activity.details %}
        <p class="activity-details">{{ activity.details }}</p>
        {% endif %}
      </div>
      <div class="activity-time">
        <time datetime="{{ activity.created_at.isoformat() }}">
          {{ activity.created_at.strftime('%I:%M %p') }}
        </time>
      </div>
    </div>
    {% else %}
    <div class="empty-state">
      <i class="fas fa-inbox"></i>
      <p>No recent activity yet. Start by creating your first project!</p>
    </div>
    {% endfor %}
  </div>
</section>

<!-- Quick Actions -->
<section class="quick-actions">
  <h2 class="section-title">Quick Actions</h2>
  <div class="actions-grid">
    <button class="action-btn" onclick="createNewProject()" title="Create a new project">
      <i class="fas fa-plus-circle"></i>
      <span>New Project</span>
    </button>
    <button class="action-btn" onclick="deployApp()" title="Deploy your application">
      <i class="fas fa-rocket"></i>
      <span>Deploy</span>
    </button>
    <button class="action-btn" onclick="runTests()" title="Run test suite">
      <i class="fas fa-vial"></i>
      <span>Run Tests</span>
    </button>
    <button class="action-btn" onclick="viewLogs()" title="View system logs">
      <i class="fas fa-file-alt"></i>
      <span>View Logs</span>
    </button>
  </div>
</section>
{% endblock %}

{% block scripts %}
<script>
  // Quick action handlers
  function createNewProject() {
    showToast('Opening project creation wizard...', 'info');
    setTimeout(() => window.location.href = '/projects', 800);
  }

  function deployApp() {
    showToast('Initiating deployment...', 'info');
    fetch('/api/deployments', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        project_id: 1,
        environment: 'production',
        version: '1.0.0'
      })
    })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          showToast('Deployment initiated successfully', 'success');
        } else {
          showToast('Deployment failed: ' + data.error, 'error');
        }
      })
      .catch(err => {
        console.error('Deployment error:', err);
        showToast('Error initiating deployment', 'error');
      });
  }

  function runTests() {
    showToast('Running test suite...', 'info');
    setTimeout(() => {
      showToast('All tests passed successfully!', 'success');
    }, 2000);
  }

  function viewLogs() {
    showToast('Loading logs...', 'info');
    setTimeout(() => window.location.href = '/analytics', 800);
  }

  // Intersection Observer for scroll animations
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('animate-in');
      }
    });
  }, observerOptions);

  document.querySelectorAll('.stat-card, .feature-card').forEach(el => {
    observer.observe(el);
  });

  // Request metrics from server
  window.addEventListener('metricsUpdate', (e) => {
    console.log('Metrics updated:', e.detail);
  });

  if (socket && socket.connected) {
    setInterval(() => {
      socket.emit('request_metrics');
    }, 5000);
  }
</script>
{% endblock %}